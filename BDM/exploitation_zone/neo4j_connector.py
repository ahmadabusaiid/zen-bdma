from pathlib import Path
import os
import sys
from neo4j import GraphDatabase

sys.path.insert(0, os.path.dirname(Path(__file__).parent.absolute()))
import configs.common as common

class Neo4jConnector:

    def __init__(self):
        
        self._host = common.neo4j['host_path']
        self._username = common.neo4j['user']
        self._password = common.neo4j['password']
        self._conn = None

    def get_conn(self):
        
        if self._conn == None :
            self._conn = GraphDatabase.driver(self._host, auth=(self._username, self._password))
        return self._conn
    
    def close_conn(self):
        self._conn.close()
        self._conn = None

