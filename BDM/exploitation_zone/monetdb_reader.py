from pathlib import Path
import os
import sys

sys.path.insert(0, os.path.dirname(Path(__file__).parent.absolute()))
import configs.common as common

class DBReader:

    def __init__(self):
        
        self._driver_path = common.monetdb['driver_path']
        self._host = common.monetdb['host_path']
        self._db = common.monetdb['database']
        self._username = common.monetdb['user']
        self._password = common.monetdb['password']
        self._driver = common.monetdb['driver']

    def get_driver_path (self):
        return self._driver_path

    def read_table(self, spark , query):
            df = spark.read \
                    .format("jdbc") \
                    .option("url", f"jdbc:{self._host}/{self._db}") \
                    .option("driver", self.driver) \
                    .option("query", query) \
                    .option("user", self._username) \
                    .option("password", self._password) \
                    .load()
            return df 